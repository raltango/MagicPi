<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<item>
<title>[COLOR lime]BUSCADOR[/COLOR][COLOR deeppink](...) [/COLOR] </title>
<link>$doregex[lista]</link>
 
<regex>
<name>lista</name>
  <listrepeat><![CDATA[
         <SetViewMode>55</SetViewMode>
         <title>$pyFunction:'[lista.param3]'.replace(".mp4", "  [COLOR deeppink]Mgck[/COLOR][COLOR lime]Pi[/COLOR]").replace(".avi", "  [COLOR deeppink]Mgck[/COLOR][COLOR lime]Pi[/COLOR]").replace(".mkv", "[COLOR deeppink]Mgck[/COLOR][COLOR lime]Pi[/COLOR]")</title>
        <link>$doregex[getUrl]</link>
        <thumbnail>https://i.imgur.com/aJ4O796.png</thumbnail>
        ]]></listrepeat>
<expres><![CDATA[href=\"(.*?,(.*?)\..*?)\".*?preview">(.*?mkv|.*?mp4|.*?avi)<]]><expres>
<page>http://diskokosmiko.mx/action/SearchFiles?Phrase=MagyckPi&amp;Mode=List&amp;Type=Video&amp;SizeFromMB=0&amp;SizeToMB=0&amp;pageNumber=10</page>
<rawpost>Phrase=$doregex[search]&__RequestVerificationToken=$doregex[tok]</rawpost>
<referer>http://diskokosmiko.mx/action/SearchFiles</referer>
<connection>keep-alive</connection>
<accept>*/*</accept>
<X-Req>XMLHttpRequest</X-Req>
<cookieJar>d248aa4e1e697a53b195098a52759e8d21507325199</cookieJar>
</regex>
 
 
 
<regex>
<name>search</name>
<expres><![CDATA[#$pyFunction
import xbmc
import xbmcaddon
import xbmcgui
def GetLSProData(page_data,Cookie_Jar,m):
    dialog = xbmcgui.Dialog()
    d = dialog.input('Buscador de peliculas y series:', type=xbmcgui.INPUT_ALPHANUM).replace(" ", "+")
    return d
]]></expres>
<page></page>
<cookieJar></cookieJar>
</regex>
 


<regex>
<name>tok</name>
<expres>DownloadFile.*RequestVerificationToken.*?value="([^"]+)<expres>
<page>http://diskokosmiko.mx/[lista.param1]</page>
<referer>http://diskokosmiko.mx/chinchetas</referer>
<connection>keep-alive</connection>
<cookieJar></cookieJar>
</regex>
 
 
 
<regex>
<name>getUrl</name>
<expres>DownloadUrl":"([^"]+)<expres>
<page>http://diskokosmiko.mx/action/DownloadFile?location=fi&amp;f=[lista.param1]</page>
<rawpost>fileId=[lista.param2]&__RequestVerificationToken=$doregex[tok2]</rawpost>
<referer>http://diskokosmiko.mx[lista.param1]</referer>
<connection>keep-alive</connection>
<accept>*/*</accept>
<X-Req>XMLHttpRequest</X-Req>
<cookieJar></cookieJar>
</regex>
 
<regex>
<name>tok2</name>
<expres>DownloadFile.*RequestVerificationToken.*?value="([^"]+)<expres>
<page>http://diskokosmiko.mx[lista.param1]</page>
<referer>http://diskokosmiko.mx/chinchetas</referer>
<connection>keep-alive</connection>
<cookieJar></cookieJar>
</regex>
 
<thumbnail>https://i.imgur.com/aJ4O796.png</thumbnail>
</item>

<regex>
<name>tok</name>
<expres>DownloadFile.*RequestVerificationToken.*?value="([^"]+)<expres>
<page>http://diskokosmiko.mx/[lista.param1]</page>
<referer>http://diskokosmiko.mx/josele89</referer>
<connection>keep-alive</connection>
<cookieJar></cookieJar>
</regex>
 
 
 
<regex>
<name>getUrl</name>
<expres>DownloadUrl":"([^"]+)<expres>
<page>http://diskokosmiko.mx/action/DownloadFile?location=fi&amp;f=[lista.param1]</page>
<rawpost>fileId=[lista.param2]&__RequestVerificationToken=$doregex[tok2]</rawpost>
<referer>http://diskokosmiko.mx[lista.param1]</referer>
<connection>keep-alive</connection>
<accept>*/*</accept>
<X-Req>XMLHttpRequest</X-Req>
<cookieJar></cookieJar>
</regex>
 
<regex>
<name>tok2</name>
<expres>DownloadFile.*RequestVerificationToken.*?value="([^"]+)<expres>
<page>http://diskokosmiko.mx[lista.param1]</page>
<referer>http://diskokosmiko.mx/josele89</referer>
<connection>keep-alive</connection>
<cookieJar></cookieJar>
</regex>
 
<thumbnail>https://i.imgur.com/aJ4O796.png</thumbnail>
</item>


<item>
<title>[COLOR springgreen]   > INFANTILES     [/COLOR]</title>
<link>$doregex[makelist]</link>
<regex>
<name>makelist</name>
<listrepeat><![CDATA[
<title>[makelist.param3]</title>
<link>$doregex[getUrl]</link>
<fanart></fanart>
<thumbnail></thumbnail>
]]></listrepeat>
<expres><![CDATA[href="\/.*,(.*?),list.*\n.*\n.*\n.*href="\/([^"]*)".*?>(.*?)<]]></expres>
<page>http://diskokosmiko.mx/jorge-garcia-luis/peliculas-infantiles-76399/list,1,12</page>
<cookieJar></cookieJar>
</regex>
<regex>
<name>getUrl</name>
<expres>DownloadUrl":"([^"]+)<expres>
<page>http://diskokosmiko.mx/action/DownloadFile?location=fi&amp;f=[makelist.param1]</page>
<rawpost>fileId=[makelist.param1]&__RequestVerificationToken=$doregex[tok]</rawpost>
<referer>http://diskokosmiko.mx/[makelist.param2]</referer>
<connection>keep-alive</connection>
<accept>*/*</accept>
<X-Req>XMLHttpRequest</X-Req>
<cookieJar></cookieJar>
</regex>
<regex>
<name>tok</name>
<expres>DownloadFile.*RequestVerificationToken.*?value="([^"]+)<expres>
<page>http://diskokosmiko.mx/[makelist.param2]</page>
<referer>http://diskokosmiko.mx/jorge-garcia-luis/peliculas-infantiles-76399/list,1,12</referer>
<connection>keep-alive</connection>
<cookieJar></cookieJar>
</regex>
<thumbnail>https://i.imgur.com/WZmP1kf.png</thumbnail>
<fanart>https://i.imgur.com/1jmxU8W.jpg</fanart>
</item>

<item>
<title>[COLOR teal]   > PELICULAS HD   [/COLOR]</title>
<link>$doregex[makelist]</link>
 
<regex>
  <name>makelist</name>
  <listrepeat><![CDATA[
        <title>[COLOR white]+- [/COLOR][COLOR yellow][makelist.param2][/COLOR]</title>
        <link>$doregex[getUrl]</link>
        <thumbnail></thumbnail>
        <fanart></fanart>
]]></listrepeat>
<expres><![CDATA[class="name[\w\W\s]{0,35}href="(.*?)"[\w\W\s]{0,50}preview">(.*?)<]]></expres>
<page>http://kbagi.com/danielsan081/pelis-hd-580121/list,1,11</page>
<cookieJar></cookieJar>
</regex>
 
<regex><name>getUrl</name>
<expres><![CDATA[#$pyFunction
import re , requests ,json
def GetLSProData(page_data,Cookie_Jar,m):
 
 ref = 'http://kbagi.com/'
 url='http://kbagi.com[makelist.param1]'
 headers = {'User-Agent': 'Mozilla/5.0 (X11; Linux i686; rv:42.0) Gecko/20100101 Firefox/42.0 Iceweasel/42.0', 'Referer': ref ,
            'X-Requested-With' : 'XMLHttpRequest' , 'Accept' : '*/*'}
 session = requests.Session()
 r = session.get(url, headers=headers)
 rv1 = r.cookies
 
 vfile , vtoken = re.findall('action/DownloadFile.*?fileId.*?value="(.*?)".*?Token".*?value="(.*?)"', r.text)[0]
 data_a ={'fileId': vfile , '__RequestVerificationToken': vtoken}
 nr = requests.post('http://kbagi.com/action/DownloadFile?location=fi&f=%s'%vfile , headers=headers,cookies=rv1 , data=data_a).text
 nrj=json.loads(nr)
 nr = nrj['Content']
 r2 = re.findall(r'(?s)value=\"(.*?)\"', nr)[0]
 data_a ={'__RequestVerificationToken': r2 , 'Username': 'Addonfesta' , 'Password' : 'addonfesta2017'}
 nr1 = requests.post('http://kbagi.com/action/Account/Login', headers=headers,cookies = rv1 , data=data_a)
 print nr1.headers['Set-Cookie']
 rasp = re.findall('ASPXAUTH_v2=(.*?);', nr1.headers['Set-Cookie'])[0]
 rv1['.ASPXAUTH_v2'] = rasp
 data_a ={'fileId': vfile , '__RequestVerificationToken': vtoken}
 nr3 = requests.post('http://kbagi.com/action/DownloadFile?location=fi&f=%s'%vfile , headers=headers, cookies = rv1 , data=data_a).text
 r3 = re.findall('DownloadUrl":"(.*?)"', nr3)[0]
 print r3
 return r3
]]></expres>
<page></page>
<cookieJar></cookieJar>
</regex>
<thumbnail></thumbnail>
<fanart></fanart>
</item>



<item>
<title>[COLOR orange]   > CANCIONES PELICULAS DISNEY    [/COLOR]</title>
<link>$doregex[makelist2]</link>

<regex>
<name>makelist2</name>
<listrepeat><![CDATA[
<title>PÃ¡gina [makelist2.param1]</title>
<link>$doregex[makelist3]</link>
<referer></referer>
<thumbnail></thumbnail>
]]></listrepeat>
<expres> (.*?),</expres>
<page>$doregex[get-number]</page>
<cookieJar></cookieJar>
</regex>

<regex>
            <name>makelist3</name>
            <listrepeat><![CDATA[
                        <title>[COLOR deeppink] >>[/COLOR][COLOR powderblue][makelist3.param2][/COLOR]</title>
                        <link>plugin://plugin.video.youtube/play/?video_id=[makelist3.param1]</link>
                        <thumbnail>https://i.ytimg.com/vi/[makelist3.param1]/hqdefault.jpg</thumbnail>
            ]]></listrepeat>
            <expres>spf-link " dir="ltr" href="\/watch\?v=(.*?)&amp;.*?\n(.*)</expres>
            <page>$doregex[get-source-page]</page>
             <cookieJar></cookieJar>
</regex>

<regex>
<name>get-number</name>
<expres><![CDATA[#$pyFunction
def GetLSProData(page_data,Cookie_Jar,m):            

 import requests
 import re
 url='https://www.youtube.com/playlist?list=PLjn-ZEBNFTy-iEuRU6JtBXtFmMnAQ-o25'
 headers = {'User-Agent': 'Mozilla/5.0 (X11; Linux i686; rv:42.0) Gecko/20100101 Firefox/42.0 Iceweasel/42.0', 'Accept-Language': 'en-US'}

 rr = requests.get(url, headers=headers)
 number = re.findall('</a></li><li>(.*?) vid', rr.text)[0]
 #number = number.encode('unicode-escape')
 number = number.replace(',', '')
 real = int(float(number)) / 100
 real2 = real + 3

 liste = list(range(real2))
 return liste
]]></expres>
<page></page>
</regex>

<regex>
<name>get-source-page</name>
<expres><![CDATA[#$pyFunction
def GetLSProData(page_data,Cookie_Jar,m):

 import requests
 import re
 import json

 pageUrl='https://www.youtube.com/playlist?list=PLjn-ZEBNFTy-iEuRU6JtBXtFmMnAQ-o25'
 headers = {'User-Agent': 'Mozilla/5.0 (X11; Linux i686; rv:42.0) Gecko/20100101 Firefox/42.0 Iceweasel/42.0'}
 r1 = requests.get(pageUrl, headers = headers)
 source = r1.text
 page = [makelist2.param1]
 N = int(float(page))
 pre = 'https://www.youtube.com'
 if (N > 1):

   for itr in range (1,N):
    continuex = re.findall('data-uix-load-more-href="(.*?)"', source)[0]
    continuationx = pre + continuex
    r = requests.get(continuationx, headers = headers)
    source = r.text
    jdata = json.loads(source)
    source = jdata["load_more_widget_html"]
    page = jdata["content_html"]
   return page
    
 else:

  return source
]]></expres>
<page></page>
</regex>
<thumbnail>http://2.bp.blogspot.com/-Byzrt0KhvYY/VmhwLtPjRYI/AAAAAAAABOg/jYV8oXmOT28/s400/posadas%2B001.jpg</thumbnail>
<fanart>https://www.euroresidentes.com/navidad/img_09/navidades_01.jpg</fanart>
</item>